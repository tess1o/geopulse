"use strict";(globalThis.webpackChunkdocs_website=globalThis.webpackChunkdocs_website||[]).push([[3827],{2726:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"system-administration/configuration/oidc-sso","title":"OIDC Authentication","description":"GeoPulse supports OpenID Connect (OIDC) authentication for single sign-on with popular providers like Google, Microsoft,","source":"@site/docs/system-administration/configuration/oidc-sso.md","sourceDirName":"system-administration/configuration","slug":"/system-administration/configuration/oidc-sso","permalink":"/geopulse/docs/system-administration/configuration/oidc-sso","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"User Registration Management","permalink":"/geopulse/docs/system-administration/configuration/user-registration"},"next":{"title":"Reverse Geocoding","permalink":"/geopulse/docs/system-administration/configuration/reverse-geocoding"}}');var l=i(4848),s=i(8453);const o={},t="OIDC Authentication",c={},d=[{value:"\u26a0\ufe0f Prerequisites",id:"\ufe0f-prerequisites",level:2},{value:"Configuration Pattern",id:"configuration-pattern",level:2},{value:"Required Properties",id:"required-properties",level:3},{value:"Optional Properties",id:"optional-properties",level:3},{value:"OIDC Callback URL",id:"oidc-callback-url",level:2},{value:"Supported Providers",id:"supported-providers",level:2},{value:"Google",id:"google",level:3},{value:"Microsoft Azure AD",id:"microsoft-azure-ad",level:3},{value:"Keycloak",id:"keycloak",level:3},{value:"Auth0",id:"auth0",level:3},{value:"PocketID",id:"pocketid",level:3},{value:"GitLab",id:"gitlab",level:3},{value:"GitHub (via OIDC proxy)",id:"github-via-oidc-proxy",level:3},{value:"Icon Support",id:"icon-support",level:2},{value:"Global OIDC Configuration",id:"global-oidc-configuration",level:2},{value:"Multiple Providers",id:"multiple-providers",level:2},{value:".env file example",id:"env-file-example",level:4},{value:"Notes",id:"notes",level:4},{value:"Account Linking Behavior",id:"account-linking-behavior",level:2},{value:"Default Behavior (Auto-Link Disabled)",id:"default-behavior-auto-link-disabled",level:3},{value:"Auto-Link Enabled",id:"auto-link-enabled",level:3},{value:"Kubernetes / Helm Configuration",id:"kubernetes--helm-configuration",level:2},{value:"Supported Providers in Helm",id:"supported-providers-in-helm",level:3},{value:"Google OIDC Configuration",id:"google-oidc-configuration",level:3},{value:"Microsoft Azure AD Configuration",id:"microsoft-azure-ad-configuration",level:3},{value:"Keycloak / Authentik / Generic OIDC Configuration",id:"keycloak--authentik--generic-oidc-configuration",level:3},{value:"Multiple Providers in Helm",id:"multiple-providers-in-helm",level:3},{value:"Additional OIDC Providers (Advanced)",id:"additional-oidc-providers-advanced",level:3},{value:"Managing OIDC Secrets in Kubernetes",id:"managing-oidc-secrets-in-kubernetes",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"oidc-authentication",children:"OIDC Authentication"})}),"\n",(0,l.jsx)(n.p,{children:"GeoPulse supports OpenID Connect (OIDC) authentication for single sign-on with popular providers like Google, Microsoft,\nKeycloak, Auth0, and many others. All OIDC providers are configured using environment variables with a unified pattern."}),"\n",(0,l.jsx)(n.h2,{id:"\ufe0f-prerequisites",children:"\u26a0\ufe0f Prerequisites"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"OIDC must be globally enabled first:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# REQUIRED: Enable OIDC authentication globally\nGEOPULSE_OIDC_ENABLED=true\n"})}),"\n",(0,l.jsx)(n.p,{children:"Without this setting, all provider configurations will be ignored and OIDC authentication will not be available."}),"\n",(0,l.jsx)(n.h2,{id:"configuration-pattern",children:"Configuration Pattern"}),"\n",(0,l.jsx)(n.p,{children:"All OIDC providers use the same environment variable pattern:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_{NAME}_{PROPERTY}=value\n"})}),"\n",(0,l.jsx)(n.h3,{id:"required-properties",children:"Required Properties"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Property"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Example"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ENABLED"})}),(0,l.jsx)(n.td,{children:"Enable/disable the provider"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"true"})," or ",(0,l.jsx)(n.code,{children:"false"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"NAME"})}),(0,l.jsx)(n.td,{children:"Display name shown in UI"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Google"}),", ",(0,l.jsx)(n.code,{children:"Company SSO"}),", etc."]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CLIENT_ID"})}),(0,l.jsx)(n.td,{children:"OAuth 2.0 client ID"}),(0,l.jsx)(n.td,{children:"Provider-specific client ID"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CLIENT_SECRET"})}),(0,l.jsx)(n.td,{children:"OAuth 2.0 client secret"}),(0,l.jsx)(n.td,{children:"Provider-specific secret"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"DISCOVERY_URL"})}),(0,l.jsx)(n.td,{children:"OIDC discovery endpoint"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"https://provider.com/.well-known/openid-configuration"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"optional-properties",children:"Optional Properties"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Property"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Example"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ICON"})}),(0,l.jsx)(n.td,{children:"CSS icon class for UI"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"pi pi-google"}),", ",(0,l.jsx)(n.code,{children:"pi pi-microsoft"})]})]})})]}),"\n",(0,l.jsx)(n.h2,{id:"oidc-callback-url",children:"OIDC Callback URL"}),"\n",(0,l.jsxs)(n.p,{children:["For all OIDC providers, you must configure a callback URL. This is the URL that the provider will redirect to after\nauthentication. All providers should use the callback URL: ",(0,l.jsx)(n.code,{children:"http://your-ip-address:port/oidc/callback"})," or\n",(0,l.jsx)(n.code,{children:"https://geopulse.mydomain.com/oidc/callback"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["Additionally you might need to update ",(0,l.jsx)(n.code,{children:"GEOPULSE_OIDC_CALLBACK_BASE_URL"})," environment variable to match your frontend\nURL. By default it's set to ",(0,l.jsx)(n.code,{children:"GEOPULSE_UI_URL"})," but in case if you have multiple domains you might need to change it to a\nsingle one."]}),"\n",(0,l.jsx)(n.h2,{id:"supported-providers",children:"Supported Providers"}),"\n",(0,l.jsx)(n.p,{children:"The system supports any OIDC-compliant provider. Here are configuration examples for popular providers:"}),"\n",(0,l.jsx)(n.h3,{id:"google",children:"Google"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_GOOGLE_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_GOOGLE_NAME=Google\nGEOPULSE_OIDC_PROVIDER_GOOGLE_CLIENT_ID=your-google-client-id\nGEOPULSE_OIDC_PROVIDER_GOOGLE_CLIENT_SECRET=your-google-client-secret\nGEOPULSE_OIDC_PROVIDER_GOOGLE_DISCOVERY_URL=https://accounts.google.com/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_GOOGLE_ICON=pi pi-google\n"})}),"\n",(0,l.jsx)(n.h3,{id:"microsoft-azure-ad",children:"Microsoft Azure AD"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_MICROSOFT_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_MICROSOFT_NAME=Microsoft\nGEOPULSE_OIDC_PROVIDER_MICROSOFT_CLIENT_ID=your-azure-client-id\nGEOPULSE_OIDC_PROVIDER_MICROSOFT_CLIENT_SECRET=your-azure-client-secret\nGEOPULSE_OIDC_PROVIDER_MICROSOFT_DISCOVERY_URL=https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_MICROSOFT_ICON=pi pi-microsoft\n"})}),"\n",(0,l.jsx)(n.h3,{id:"keycloak",children:"Keycloak"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_KEYCLOAK_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_KEYCLOAK_NAME=Company SSO\nGEOPULSE_OIDC_PROVIDER_KEYCLOAK_CLIENT_ID=geopulse-client\nGEOPULSE_OIDC_PROVIDER_KEYCLOAK_CLIENT_SECRET=your-keycloak-secret\nGEOPULSE_OIDC_PROVIDER_KEYCLOAK_DISCOVERY_URL=https://keycloak.company.com/auth/realms/master/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_KEYCLOAK_ICON=pi pi-key\n"})}),"\n",(0,l.jsx)(n.h3,{id:"auth0",children:"Auth0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_AUTH0_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_AUTH0_NAME=Auth0\nGEOPULSE_OIDC_PROVIDER_AUTH0_CLIENT_ID=your-auth0-client-id\nGEOPULSE_OIDC_PROVIDER_AUTH0_CLIENT_SECRET=your-auth0-client-secret\nGEOPULSE_OIDC_PROVIDER_AUTH0_DISCOVERY_URL=https://your-domain.auth0.com/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_AUTH0_ICON=pi pi-shield\n"})}),"\n",(0,l.jsx)(n.h3,{id:"pocketid",children:"PocketID"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_POCKETID_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_POCKETID_NAME=PocketID\nGEOPULSE_OIDC_PROVIDER_POCKETID_CLIENT_ID=your-pocketid-client-id\nGEOPULSE_OIDC_PROVIDER_POCKETID_CLIENT_SECRET=your-pocketid-secret\nGEOPULSE_OIDC_PROVIDER_POCKETID_DISCOVERY_URL=https://pocketid.example.com/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_POCKETID_ICON=pi pi-id-card\n"})}),"\n",(0,l.jsx)(n.h3,{id:"gitlab",children:"GitLab"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_GITLAB_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_GITLAB_NAME=GitLab\nGEOPULSE_OIDC_PROVIDER_GITLAB_CLIENT_ID=your-gitlab-client-id\nGEOPULSE_OIDC_PROVIDER_GITLAB_CLIENT_SECRET=your-gitlab-secret\nGEOPULSE_OIDC_PROVIDER_GITLAB_DISCOVERY_URL=https://gitlab.com/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_GITLAB_ICON=pi pi-code\n"})}),"\n",(0,l.jsx)(n.h3,{id:"github-via-oidc-proxy",children:"GitHub (via OIDC proxy)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"GEOPULSE_OIDC_PROVIDER_GITHUB_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_GITHUB_NAME=GitHub\nGEOPULSE_OIDC_PROVIDER_GITHUB_CLIENT_ID=your-github-client-id\nGEOPULSE_OIDC_PROVIDER_GITHUB_CLIENT_SECRET=your-github-secret\nGEOPULSE_OIDC_PROVIDER_GITHUB_DISCOVERY_URL=https://your-oidc-proxy.com/.well-known/openid-configuration\nGEOPULSE_OIDC_PROVIDER_GITHUB_ICON=pi pi-github\n"})}),"\n",(0,l.jsx)(n.h2,{id:"icon-support",children:"Icon Support"}),"\n",(0,l.jsx)(n.p,{children:"The system provides smart icon detection for common providers. If no icon is specified, it will automatically detect\nicons based on the provider name:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Provider Pattern"}),(0,l.jsx)(n.th,{children:"Auto-detected Icon"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"google"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-google"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"microsoft"}),", ",(0,l.jsx)(n.code,{children:"azure"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-microsoft"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"keycloak"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-key"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"auth0"}),", ",(0,l.jsx)(n.code,{children:"okta"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-shield"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"gitlab"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-code"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"github"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-github"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"pocketid"}),", ",(0,l.jsx)(n.code,{children:"pocket"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-id-card"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"authentik"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-lock"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"discord"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-discord"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"facebook"}),", ",(0,l.jsx)(n.code,{children:"meta"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-facebook"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"twitter"}),", ",(0,l.jsx)(n.code,{children:"x.com"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-twitter"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"linkedin"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-linkedin"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"apple"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-apple"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"amazon"}),", ",(0,l.jsx)(n.code,{children:"aws"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-amazon"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Custom/Unknown"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pi pi-sign-in"})})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"global-oidc-configuration",children:"Global OIDC Configuration"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Required Settings:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u26a0\ufe0f REQUIRED: Enable OIDC authentication globally\nGEOPULSE_OIDC_ENABLED=true\n\n# \u26a0\ufe0f REQUIRED: Callback URL base (should match your frontend URL)\nGEOPULSE_UI_URL=https://your-domain.com\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Optional Settings:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Session and security settings\nGEOPULSE_OIDC_STATE_TOKEN_LENGTH=32\nGEOPULSE_OIDC_STATE_TOKEN_EXPIRY_MINUTES=10\n\n# Provider metadata caching\nGEOPULSE_OIDC_METADATA_CACHE_TTL_HOURS=24\nGEOPULSE_OIDC_METADATA_CACHE_MAX_SIZE=10\n\n# JWKS (JSON Web Key Set) cache TTL in hours (default: 24)\n# Controls how often OIDC provider's public keys are refreshed for token validation\nGEOPULSE_OIDC_JWKS_CACHE_TTL_HOURS=24\n\n# Cleanup settings\nGEOPULSE_OIDC_CLEANUP_ENABLED=true\n\n# Account Linking Security\n# \u26a0\ufe0f WARNING: Only enable this if you fully trust your OIDC providers to verify email ownership\n# When enabled, automatically links OIDC accounts to existing users with matching emails\n# Default: false (requires manual verification via password or existing OIDC provider)\n# Recommended for self-hosted environments with centralized SSO (Keycloak, Authentik, etc.)\nGEOPULSE_OIDC_AUTO_LINK_ACCOUNTS=false\n"})}),"\n",(0,l.jsx)(n.h2,{id:"multiple-providers",children:"Multiple Providers"}),"\n",(0,l.jsx)(n.p,{children:"You can configure multiple providers simultaneously. Users will see all enabled providers as login options:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Enable multiple providers\nGEOPULSE_OIDC_PROVIDER_GOOGLE_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_MICROSOFT_ENABLED=true  \nGEOPULSE_OIDC_PROVIDER_KEYCLOAK_ENABLED=true\nGEOPULSE_OIDC_PROVIDER_AUTH0_ENABLED=true\n\n# Each with their own configuration like name, client id, client secret, discovery url, etc...\n"})}),"\n",(0,l.jsx)(n.h4,{id:"env-file-example",children:".env file example"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'# \u26a0\ufe0f REQUIRED: Enable OIDC globally first\nGEOPULSE_OIDC_ENABLED: "true"\n\n# Google OAuth\nGEOPULSE_OIDC_PROVIDER_GOOGLE_ENABLED: "true"\nGEOPULSE_OIDC_PROVIDER_GOOGLE_NAME: "Google"\nGEOPULSE_OIDC_PROVIDER_GOOGLE_CLIENT_ID: "${GOOGLE_CLIENT_ID}"\nGEOPULSE_OIDC_PROVIDER_GOOGLE_CLIENT_SECRET: "${GOOGLE_CLIENT_SECRET}"\nGEOPULSE_OIDC_PROVIDER_GOOGLE_DISCOVERY_URL: "https://accounts.google.com/.well-known/openid-configuration"\n\n# Company Keycloak\nGEOPULSE_OIDC_PROVIDER_COMPANY_ENABLED: "true"\nGEOPULSE_OIDC_PROVIDER_COMPANY_NAME: "Company SSO"\nGEOPULSE_OIDC_PROVIDER_COMPANY_CLIENT_ID: "${COMPANY_SSO_CLIENT_ID}"\nGEOPULSE_OIDC_PROVIDER_COMPANY_CLIENT_SECRET: "${COMPANY_SSO_CLIENT_SECRET}"\nGEOPULSE_OIDC_PROVIDER_COMPANY_DISCOVERY_URL: "https://sso.company.com/auth/realms/employees/.well-known/openid-configuration"\nGEOPULSE_OIDC_PROVIDER_COMPANY_ICON: "pi pi-building"\n\n'})}),"\n",(0,l.jsx)(n.h4,{id:"notes",children:"Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"IMPORTANT"}),": ",(0,l.jsx)(n.code,{children:"GEOPULSE_OIDC_ENABLED=true"})," must be set or OIDC will not work at all"]}),"\n",(0,l.jsx)(n.li,{children:"Provider names in environment variables must be unique"}),"\n",(0,l.jsx)(n.li,{children:"Discovery URLs must be accessible from the GeoPulse backend"}),"\n",(0,l.jsx)(n.li,{children:"All providers must support the OIDC standard with discovery endpoints"}),"\n",(0,l.jsx)(n.li,{children:"Icons use PrimeIcons CSS classes"}),"\n",(0,l.jsx)(n.li,{children:"Provider configuration is validated at startup"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"account-linking-behavior",children:"Account Linking Behavior"}),"\n",(0,l.jsxs)(n.p,{children:["When a user tries to login via OIDC with an email that already exists in GeoPulse, the system behavior depends on the ",(0,l.jsx)(n.code,{children:"GEOPULSE_OIDC_AUTO_LINK_ACCOUNTS"})," setting:"]}),"\n",(0,l.jsx)(n.h3,{id:"default-behavior-auto-link-disabled",children:"Default Behavior (Auto-Link Disabled)"}),"\n",(0,l.jsxs)(n.p,{children:["By default (",(0,l.jsx)(n.code,{children:"GEOPULSE_OIDC_AUTO_LINK_ACCOUNTS=false"}),"), GeoPulse requires manual verification before linking a new OIDC provider to an existing account. The user must verify their identity through:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Password verification"}),": If the account has a password set"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"OIDC verification"}),": Login via an already-linked OIDC provider"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["This is the ",(0,l.jsx)(n.strong,{children:"recommended security setting for public-facing deployments"})," or when you don't fully control the OIDC providers."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example scenario:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["User has account with email ",(0,l.jsx)(n.code,{children:"user@example.com"})," created via password registration"]}),"\n",(0,l.jsxs)(n.li,{children:["User tries to login via Google OIDC with the same email ",(0,l.jsx)(n.code,{children:"user@example.com"})]}),"\n",(0,l.jsx)(n.li,{children:"System prompts user to verify identity (enter password OR login via another linked OIDC provider)"}),"\n",(0,l.jsx)(n.li,{children:"After verification, Google is linked to the account"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"auto-link-enabled",children:"Auto-Link Enabled"}),"\n",(0,l.jsxs)(n.p,{children:["When ",(0,l.jsx)(n.code,{children:"GEOPULSE_OIDC_AUTO_LINK_ACCOUNTS=true"}),", the system automatically links OIDC accounts to existing users with matching emails ",(0,l.jsx)(n.strong,{children:"without requiring verification"}),"."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u26a0\ufe0f Security Implications:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Only enable this if you ",(0,l.jsx)(n.strong,{children:"fully trust your OIDC providers"})," to verify email ownership"]}),"\n",(0,l.jsxs)(n.li,{children:["Recommended ",(0,l.jsx)(n.strong,{children:"only for self-hosted environments"})," with centralized SSO (Keycloak, Authentik, etc.)"]}),"\n",(0,l.jsx)(n.li,{children:"If an attacker can control an OIDC provider or compromise one, they could gain access to any account by claiming the email"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Use cases for enabling auto-link:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Self-hosted environments with enterprise SSO"}),"\n",(0,l.jsx)(n.li,{children:"Scenarios where all OIDC providers are managed by the same organization"}),"\n",(0,l.jsx)(n.li,{children:"When seamless user experience is prioritized over defense-in-depth"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example scenario:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["User has account with email ",(0,l.jsx)(n.code,{children:"user@company.com"})," created via password registration"]}),"\n",(0,l.jsx)(n.li,{children:"User tries to login via Company Keycloak OIDC with the same email"}),"\n",(0,l.jsx)(n.li,{children:"System automatically links Keycloak to the account and logs the user in"}),"\n",(0,l.jsx)(n.li,{children:"No verification required (trusting that Keycloak verified the email)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"kubernetes--helm-configuration",children:"Kubernetes / Helm Configuration"}),"\n",(0,l.jsxs)(n.p,{children:["The GeoPulse Helm chart provides native support for OIDC configuration via ",(0,l.jsx)(n.code,{children:"values.yaml"}),". This is the recommended approach for Kubernetes deployments."]}),"\n",(0,l.jsx)(n.h3,{id:"supported-providers-in-helm",children:"Supported Providers in Helm"}),"\n",(0,l.jsx)(n.p,{children:"The Helm chart supports three OIDC providers out of the box:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Google"})," (",(0,l.jsx)(n.code,{children:"config.oidc.google"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Microsoft"})," (",(0,l.jsx)(n.code,{children:"config.oidc.microsoft"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Generic OIDC"})," (",(0,l.jsx)(n.code,{children:"config.oidc.generic"}),") - for Keycloak, Authentik, Okta, Auth0, etc."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"google-oidc-configuration",children:"Google OIDC Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# values.yaml or custom-values.yaml\nconfig:\n  oidc:\n    enabled: true\n    google:\n      enabled: true\n      clientId: "your-google-client-id.apps.googleusercontent.com"\n      clientSecret: "your-google-client-secret"\n'})}),"\n",(0,l.jsx)(n.p,{children:"Apply with:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"helm upgrade geopulse ./helm/geopulse -f custom-values.yaml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"microsoft-azure-ad-configuration",children:"Microsoft Azure AD Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'config:\n  oidc:\n    enabled: true\n    microsoft:\n      enabled: true\n      clientId: "your-azure-client-id"\n      clientSecret: "your-azure-client-secret"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"keycloak--authentik--generic-oidc-configuration",children:"Keycloak / Authentik / Generic OIDC Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'config:\n  oidc:\n    enabled: true\n    autoLinkAccounts: false  # See security note above\n    cleanupEnabled: true\n    jwksCacheTtlHours: 24    # Optional: JWKS cache TTL (default: 24)\n    generic:\n      enabled: true\n      name: "Company SSO"  # Display name in UI\n      clientId: "geopulse"\n      clientSecret: "your-keycloak-client-secret"\n      discoveryUrl: "https://keycloak.example.com/realms/master/.well-known/openid-configuration"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"multiple-providers-in-helm",children:"Multiple Providers in Helm"}),"\n",(0,l.jsx)(n.p,{children:"You can enable multiple providers simultaneously:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'config:\n  oidc:\n    enabled: true\n    google:\n      enabled: true\n      clientId: "..."\n      clientSecret: "..."\n    microsoft:\n      enabled: true\n      clientId: "..."\n      clientSecret: "..."\n    generic:\n      enabled: true\n      name: "Company SSO"\n      clientId: "..."\n      clientSecret: "..."\n      discoveryUrl: "..."\n'})}),"\n",(0,l.jsx)(n.h3,{id:"additional-oidc-providers-advanced",children:"Additional OIDC Providers (Advanced)"}),"\n",(0,l.jsx)(n.p,{children:"If you need to configure OIDC providers beyond the three built-in options (e.g., Auth0, GitLab, multiple Keycloak realms), use custom environment variables:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'backend:\n  extraEnv:\n    - name: GEOPULSE_OIDC_PROVIDER_AUTH0_ENABLED\n      value: "true"\n    - name: GEOPULSE_OIDC_PROVIDER_AUTH0_NAME\n      value: "Auth0"\n    - name: GEOPULSE_OIDC_PROVIDER_AUTH0_CLIENT_ID\n      value: "your-auth0-client-id"\n    - name: GEOPULSE_OIDC_PROVIDER_AUTH0_DISCOVERY_URL\n      value: "https://your-domain.auth0.com/.well-known/openid-configuration"\n    - name: GEOPULSE_OIDC_PROVIDER_AUTH0_CLIENT_SECRET\n      valueFrom:\n        secretKeyRef:\n          name: geopulse-oidc-secrets\n          key: auth0-client-secret\n'})}),"\n",(0,l.jsx)(n.p,{children:"First, create the secret:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl create secret generic geopulse-oidc-secrets \\\n  --from-literal=auth0-client-secret='your-auth0-client-secret'\n"})}),"\n",(0,l.jsx)(n.h3,{id:"managing-oidc-secrets-in-kubernetes",children:"Managing OIDC Secrets in Kubernetes"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Security Best Practices:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Use Kubernetes Secrets"})," - Never commit client secrets to Git"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Use Sealed Secrets"})," - For GitOps workflows, encrypt secrets with Sealed Secrets or External Secrets Operator"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Rotate secrets regularly"})," - Update secrets periodically and restart pods"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example using kubectl:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Create OIDC secrets\nkubectl create secret generic geopulse-oidc \\\n  --from-literal=google-client-secret='...' \\\n  --from-literal=microsoft-client-secret='...' \\\n  --from-literal=keycloak-client-secret='...'\n\n# Update values.yaml to reference secrets\n# (Note: The Helm chart already handles this automatically)\n"})}),"\n",(0,l.jsxs)(n.p,{children:["For more details on Helm configuration, see the ",(0,l.jsx)(n.a,{href:"/docs/getting-started/deployment/helm-deployment",children:"Helm Configuration Guide"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"OIDC providers not showing on login page:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Verify ",(0,l.jsx)(n.code,{children:"GEOPULSE_OIDC_ENABLED=true"})," is set (or ",(0,l.jsx)(n.code,{children:"config.oidc.enabled: true"})," in Helm)"]}),"\n",(0,l.jsxs)(n.li,{children:["Check that individual provider ",(0,l.jsx)(n.code,{children:"_ENABLED=true"})," settings are configured"]}),"\n",(0,l.jsx)(n.li,{children:"Ensure all required properties (client-id, client-secret, discovery-url) are provided"}),"\n",(0,l.jsx)(n.li,{children:"Check application logs for provider initialization errors"}),"\n",(0,l.jsx)(n.li,{children:"For Kubernetes: Verify ConfigMap and Secret contain the OIDC configuration"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Account linking errors:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"If auto-link is disabled, users must verify identity before linking new OIDC providers"}),"\n",(0,l.jsx)(n.li,{children:"Check that the email from OIDC provider matches the existing account email exactly"}),"\n",(0,l.jsx)(n.li,{children:"Review application logs for security warnings related to account linking"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>t});var r=i(6540);const l={},s=r.createContext(l);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);