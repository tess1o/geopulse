"use strict";(globalThis.webpackChunkdocs_website=globalThis.webpackChunkdocs_website||[]).push([[2285],{7393:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"user-guide/gps-sources/home_assistant","title":"Using Home Assistant with GeoPulse","description":"A step-by-step guide on how to configure Home Assistant to send location data to GeoPulse.","source":"@site/docs/user-guide/gps-sources/home_assistant.md","sourceDirName":"user-guide/gps-sources","slug":"/user-guide/gps-sources/home_assistant","permalink":"/geopulse/docs/user-guide/gps-sources/home_assistant","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Using Home Assistant with GeoPulse","description":"A step-by-step guide on how to configure Home Assistant to send location data to GeoPulse."},"sidebar":"docsSidebar","previous":{"title":"Using Overland with GeoPulse","permalink":"/geopulse/docs/user-guide/gps-sources/overland"},"next":{"title":"Using GPSLogger with GeoPulse","permalink":"/geopulse/docs/user-guide/gps-sources/gps_logger"}}');var o=s(4848),i=s(8453);const a={title:"Using Home Assistant with GeoPulse",description:"A step-by-step guide on how to configure Home Assistant to send location data to GeoPulse."},r="Using Home Assistant with GeoPulse",l={},c=[{value:"Step 1: Configure GeoPulse",id:"step-1-configure-geopulse",level:2},{value:"Step 2: Configure Home Assistant",id:"step-2-configure-home-assistant",level:2},{value:"2.1: Update <code>configuration.yaml</code>",id:"21-update-configurationyaml",level:3},{value:"2.2: Update <code>automations.yaml</code>",id:"22-update-automationsyaml",level:3},{value:"2.3: Restart Home Assistant",id:"23-restart-home-assistant",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"using-home-assistant-with-geopulse",children:"Using Home Assistant with GeoPulse"})}),"\n",(0,o.jsx)(t.p,{children:"This integration allows you to leverage Home Assistant's powerful device tracking capabilities to send location updates to GeoPulse. This is particularly useful if you already have device trackers configured in Home Assistant (e.g., for mobile apps, router-based tracking, etc.)."}),"\n",(0,o.jsx)(t.p,{children:"This guide will walk you through the required configuration in both GeoPulse and your Home Assistant setup."}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"step-1-configure-geopulse",children:"Step 1: Configure GeoPulse"}),"\n",(0,o.jsx)(t.p,{children:"First, you need to create a new location source in GeoPulse that will receive the data from Home Assistant."}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["In your GeoPulse account, navigate to ",(0,o.jsx)(t.strong,{children:"Settings -> Location Sources"}),"."]}),"\n",(0,o.jsxs)(t.li,{children:["Click ",(0,o.jsx)(t.strong,{children:"Add New Source"})," and select ",(0,o.jsx)(t.strong,{children:"Home Assistant"}),"."]}),"\n",(0,o.jsxs)(t.li,{children:["Enter a secure and unique ",(0,o.jsx)(t.strong,{children:"Token"}),". This token will be used to authorize requests from Home Assistant."]}),"\n",(0,o.jsxs)(t.li,{children:["Click ",(0,o.jsx)(t.strong,{children:"Save"})," to create the new location source. Make sure to copy the generated token for the next step."]}),"\n"]}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"step-2-configure-home-assistant",children:"Step 2: Configure Home Assistant"}),"\n",(0,o.jsxs)(t.p,{children:["After setting up the source in GeoPulse, you will need to modify your Home Assistant configuration files (",(0,o.jsx)(t.code,{children:"configuration.yaml"})," and ",(0,o.jsx)(t.code,{children:"automations.yaml"}),") to send location data to GeoPulse."]}),"\n",(0,o.jsxs)(t.h3,{id:"21-update-configurationyaml",children:["2.1: Update ",(0,o.jsx)(t.code,{children:"configuration.yaml"})]}),"\n",(0,o.jsxs)(t.p,{children:["Add the following ",(0,o.jsx)(t.code,{children:"rest_command"})," entry to your ",(0,o.jsx)(t.code,{children:"configuration.yaml"})," file. This defines a service that Home Assistant can call to send data to GeoPulse."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-yaml",children:'rest_command:\n  send_gps_data:\n    url: "https://geopulse.yourdomain.com/api/homeassistant"\n    method: POST\n    headers:\n      content-type: "application/json"\n      Authorization: Bearer YOUR_CONFIGURED_TOKEN\n    payload: >\n      {\n        "device_id": "iphone_16",\n        "timestamp": "{{ now().isoformat() }}",\n        "location": {\n          "latitude": {{ state_attr(\'device_tracker.iphone_16\', \'latitude\') }},\n          "longitude": {{ state_attr(\'device_tracker.iphone_16\', \'longitude\') }},\n          "accuracy": {{ state_attr(\'device_tracker.iphone_16\', \'gps_accuracy\') | default(0, true) }},\n          "altitude": {{ state_attr(\'device_tracker.iphone_16\', \'altitude\') | default(0, true) }},\n          "speed": {{ state_attr(\'device_tracker.iphone_16\', \'speed\') | default(0, true) }}\n        },\n        "battery": {\n          "level": {{ state_attr(\'device_tracker.iphone_16\', \'battery_level\') | default(states(\'sensor.iphone_16_battery_level\'), true) | default(0, true) }}\n        }\n      }\n'})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Important Replacements:"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Replace ",(0,o.jsx)(t.code,{children:"https://geopulse.yourdomain.com"})," with the actual domain of your GeoPulse server."]}),"\n",(0,o.jsxs)(t.li,{children:["Replace ",(0,o.jsx)(t.code,{children:"YOUR_CONFIGURED_TOKEN"})," with the token you generated in GeoPulse in Step 1."]}),"\n",(0,o.jsxs)(t.li,{children:["Replace ",(0,o.jsx)(t.code,{children:"iphone_16"})," with the actual ",(0,o.jsx)(t.code,{children:"entity_id"})," of your device tracker in Home Assistant."]}),"\n"]}),"\n",(0,o.jsxs)(t.h3,{id:"22-update-automationsyaml",children:["2.2: Update ",(0,o.jsx)(t.code,{children:"automations.yaml"})]}),"\n",(0,o.jsxs)(t.p,{children:["Next, add an automation that triggers the ",(0,o.jsx)(t.code,{children:"send_gps_data"})," service whenever your device tracker's state changes."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-yaml",children:"- alias: Send GPS data to GeoPulse\n  trigger:\n    - platform: state\n      entity_id: device_tracker.iphone_16 # Replace with your device tracker's entity_id\n  action:\n    - service: rest_command.send_gps_data\n"})}),"\n",(0,o.jsx)(t.h3,{id:"23-restart-home-assistant",children:"2.3: Restart Home Assistant"}),"\n",(0,o.jsxs)(t.p,{children:["After modifying ",(0,o.jsx)(t.code,{children:"configuration.yaml"})," and ",(0,o.jsx)(t.code,{children:"automations.yaml"}),", you must restart your Home Assistant server for the changes to take effect."]}),"\n",(0,o.jsx)(t.p,{children:"Once Home Assistant restarts, it will begin sending location updates to your GeoPulse account, which will be automatically processed to build your timeline."})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>r});var n=s(6540);const o={},i=n.createContext(o);function a(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);