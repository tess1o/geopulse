"use strict";(globalThis.webpackChunkdocs_website=globalThis.webpackChunkdocs_website||[]).push([[422],{8172:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"getting-started/deployment/docker-compose","title":"Docker Deployment","description":"Prerequisites","source":"@site/docs/getting-started/deployment/docker-compose.md","sourceDirName":"getting-started/deployment","slug":"/getting-started/deployment/docker-compose","permalink":"/geopulse/docs/getting-started/deployment/docker-compose","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Architecture Overview","permalink":"/geopulse/docs/getting-started/architecture-overview"},"next":{"title":"Kubernetes Deployment","permalink":"/geopulse/docs/getting-started/deployment/kubernetes-helm"}}');var r=s(4848),i=s(8453);const t={},c="Docker Deployment",l={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Overview about the system components",id:"overview-about-the-system-components",level:2},{value:"Docker Compose Deployment",id:"docker-compose-deployment",level:2},{value:"1. Download Configuration Files",id:"1-download-configuration-files",level:3},{value:"Step 1.1: Download <code>.env</code> configuration and <code>generate-keys.sh</code> script",id:"step-11-download-env-configuration-and-generate-keyssh-script",level:4},{value:"Step 1.2: Choose your deployment type",id:"step-12-choose-your-deployment-type",level:4},{value:"A Note on Docker Image Source",id:"a-note-on-docker-image-source",level:4},{value:"Multi-Architecture Support",id:"multi-architecture-support",level:4},{value:"CPU Compatibility Issues",id:"cpu-compatibility-issues",level:4},{value:"2. Configure Environment (<code>.env</code>)",id:"2-configure-environment-env",level:3},{value:"Core Configuration",id:"core-configuration",level:4},{value:"MQTT Configuration",id:"mqtt-configuration",level:4},{value:"Web Access &amp; Security Configuration",id:"web-access--security-configuration",level:4},{value:"Understanding GEOPULSE_COOKIE_DOMAIN",id:"understanding-geopulse_cookie_domain",level:5},{value:"Advanced Performance Tuning",id:"advanced-performance-tuning",level:4},{value:"Database Performance Tuning",id:"database-performance-tuning",level:3},{value:"Deployment-Specific Database Settings",id:"deployment-specific-database-settings",level:4},{value:"Environment Variable Configuration",id:"environment-variable-configuration",level:4},{value:"Example Custom Configuration for High-Performance Setup",id:"example-custom-configuration-for-high-performance-setup",level:4},{value:"GPS Workload Optimizations",id:"gps-workload-optimizations",level:4},{value:"Monitoring Database Performance",id:"monitoring-database-performance",level:4},{value:"3. Start GeoPulse",id:"3-start-geopulse",level:3},{value:"Production Deployment Example: Reverse Proxy",id:"production-deployment-example-reverse-proxy",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"docker-deployment",children:"Docker Deployment"})}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Before you begin, ensure you have the following installed:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:"Docker"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"Docker Compose"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"overview-about-the-system-components",children:"Overview about the system components"}),"\n",(0,r.jsx)(n.p,{children:"GeoPulse consists of 3 mandatory services and one optional service:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"GeoPulse Backend - mandatory"}),"\n",(0,r.jsx)(n.li,{children:"GeoPulse Frontend - mandatory"}),"\n",(0,r.jsx)(n.li,{children:"GeoPulse Postgres (Postgis) database - mandatory"}),"\n",(0,r.jsx)(n.li,{children:"MQTT Broker (Mosquitto) - optional"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"MQTT broker can be deployed if you want to use OwnTracks integration with MQTT protocol. If you don't use OwnTracks or\nwant to use OwnTracks with HTTP - you don't need the MQTT broker. This guide provides steps on how to install the system\nwith or without MQTT broker."}),"\n",(0,r.jsx)(n.p,{children:'There is one-time service "geopulse-keygen" that creates JWT keys and AI encryption key in the "keys" folder. It starts\nand stops automatically, no manual steps are required.'}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"docker-compose-deployment",children:"Docker Compose Deployment"}),"\n",(0,r.jsx)(n.p,{children:"This section guides you through deploying GeoPulse using Docker Compose."}),"\n",(0,r.jsx)(n.h3,{id:"1-download-configuration-files",children:"1. Download Configuration Files"}),"\n",(0,r.jsx)(n.p,{children:"First, download the necessary configuration files."}),"\n",(0,r.jsxs)(n.h4,{id:"step-11-download-env-configuration-and-generate-keyssh-script",children:["Step 1.1: Download ",(0,r.jsx)(n.code,{children:".env"})," configuration and ",(0,r.jsx)(n.code,{children:"generate-keys.sh"})," script"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using wget:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget -O .env https://raw.githubusercontent.com/tess1o/GeoPulse/main/.env.example\nwget https://raw.githubusercontent.com/tess1o/GeoPulse/main/generate-keys.sh\nchmod +x generate-keys.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using curl:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -L -o .env https://raw.githubusercontent.com/tess1o/GeoPulse/main/.env.example\ncurl -L -o generate-keys.sh https://raw.githubusercontent.com/tess1o/GeoPulse/main/generate-keys.sh\nchmod +x generate-keys.sh\n"})}),"\n",(0,r.jsx)(n.h4,{id:"step-12-choose-your-deployment-type",children:"Step 1.2: Choose your deployment type"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option A: Basic deployment (without MQTT broker)"})}),"\n",(0,r.jsx)(n.p,{children:"Download the basic docker-compose.yml:"}),"\n",(0,r.jsx)(n.p,{children:"Using wget:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget -O docker-compose.yml https://raw.githubusercontent.com/tess1o/GeoPulse/main/docker-compose.yml\n"})}),"\n",(0,r.jsx)(n.p,{children:"Using curl:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -L -o docker-compose.yml https://raw.githubusercontent.com/tess1o/GeoPulse/main/docker-compose.yml\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option B: Full deployment (with MQTT broker for OwnTracks)"})}),"\n",(0,r.jsx)(n.p,{children:"Download the complete docker-compose.yml and mosquitto entrypoint script:"}),"\n",(0,r.jsx)(n.p,{children:"Using wget:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget -O docker-compose.yml https://raw.githubusercontent.com/tess1o/GeoPulse/main/docker-compose-complete.yml\nwget -O mosquitto_entrypoint.sh https://raw.githubusercontent.com/tess1o/GeoPulse/main/mosquitto_entrypoint.sh\nchmod +x mosquitto_entrypoint.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:"Using curl:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -L -o docker-compose.yml https://raw.githubusercontent.com/tess1o/GeoPulse/main/docker-compose-complete.yml\ncurl -L -o mosquitto_entrypoint.sh https://raw.githubusercontent.com/tess1o/GeoPulse/main/mosquitto_entrypoint.sh\nchmod +x mosquitto_entrypoint.sh\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.h4,{id:"a-note-on-docker-image-source",children:"A Note on Docker Image Source"}),"\n",(0,r.jsx)(n.p,{children:"By default, GeoPulse uses images from Docker Hub. We also publish images to GitHub Container Registry (GHCR)."}),"\n",(0,r.jsxs)(n.p,{children:["To switch to GHCR images, edit your ",(0,r.jsx)(n.code,{children:"docker-compose.yml"})," file. For ",(0,r.jsx)(n.code,{children:"geopulse-backend"})," and ",(0,r.jsx)(n.code,{children:"geopulse-ui"}),", comment the default ",(0,r.jsx)(n.code,{children:"image"})," and uncomment the ",(0,r.jsx)(n.code,{children:"image"})," pointing to ",(0,r.jsx)(n.code,{children:"ghcr.io"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Example for ",(0,r.jsx)(n.code,{children:"geopulse-backend"}),":"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"  geopulse-backend:\n    # image: tess1o/geopulse-backend:${GEOPULSE_VERSION}-native\n    image: ghcr.io/tess1o/geopulse-backend:${GEOPULSE_VERSION}-native\n"})}),"\n",(0,r.jsx)(n.h4,{id:"multi-architecture-support",children:"Multi-Architecture Support"}),"\n",(0,r.jsx)(n.p,{children:"The native backend images support both AMD64 and ARM64 architectures, including Raspberry Pi. Docker will automatically pull the correct image for your platform."}),"\n",(0,r.jsx)(n.h4,{id:"cpu-compatibility-issues",children:"CPU Compatibility Issues"}),"\n",(0,r.jsx)(n.p,{children:"If your backend container fails to start with an error about missing CPU features like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"The current machine does not support all of the following CPU features that are required by the image:\n[AVX2, BMI1, BMI2, FMA, F16C, LZCNT] (AMD64) or [FP, ASIMD, CRC32, LSE] (ARM64)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"This means you have an older CPU"})," that doesn't support the optimized instructions used by the default image."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Use the compatible image variant instead:"]}),"\n",(0,r.jsxs)(n.p,{children:["Edit your ",(0,r.jsx)(n.code,{children:"docker-compose.yml"})," and replace the backend image:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"  geopulse-backend:\n    # Comment out the default optimized image:\n    # image: tess1o/geopulse-backend:${GEOPULSE_VERSION}-native\n    # Use the compatible image instead:\n    image: tess1o/geopulse-backend:${GEOPULSE_VERSION}-native-compat\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Who needs the compatible image?"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Old x86 CPUs"}),": Intel pre-Haswell (before 2013), AMD pre-Excavator (before 2015)","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Examples: Intel Core i5-3470T (Ivy Bridge), Core i7-2600 (Sandy Bridge)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Raspberry Pi 3/4"}),": ARM Cortex-A53/A72 processors"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Performance Note"}),": The compatible image uses x86-64-v2 (AMD64) or armv8-a+nolse (ARM64) instruction sets, which sacrifice some performance for broader compatibility. Modern CPUs (2015+) should use the default optimized image for best performance."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"2-configure-environment-env",children:["2. Configure Environment (",(0,r.jsx)(n.code,{children:".env"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:".env"})," file is the central place for configuring your GeoPulse instance."]}),"\n",(0,r.jsx)(n.h4,{id:"core-configuration",children:"Core Configuration"}),"\n",(0,r.jsx)(n.p,{children:"It is highly recommended to set strong, unique passwords for your services."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GEOPULSE_POSTGRES_PASSWORD"}),": The password for the PostgreSQL database.","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"GEOPULSE_POSTGRES_PASSWORD=your-secure-database-password\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GEOPULSE_MQTT_PASSWORD"}),": The password for the MQTT broker. Only needed if you are using the MQTT deployment.","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"GEOPULSE_MQTT_PASSWORD=your-secure-mqtt-password\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"mqtt-configuration",children:"MQTT Configuration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GEOPULSE_MQTT_ENABLED"}),": Set to ",(0,r.jsx)(n.code,{children:"true"})," to enable the OwnTracks MQTT integration. This requires using the full deployment ",(0,r.jsx)(n.code,{children:"docker-compose.yml"}),".","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"GEOPULSE_MQTT_ENABLED=true\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"web-access--security-configuration",children:"Web Access & Security Configuration"}),"\n",(0,r.jsx)(n.p,{children:"These variables control how users access the GeoPulse frontend and how authentication cookies are handled."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GEOPULSE_UI_URL"}),": A comma-separated list of URLs that can be used to access the frontend. This is crucial for CORS (Cross-Origin Resource Sharing) to work correctly."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GEOPULSE_COOKIE_DOMAIN"}),": The domain for authentication cookies. ",(0,r.jsx)(n.strong,{children:"Keep empty for standard deployments"})," (see details below)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GEOPULSE_AUTH_SECURE_COOKIES"}),": Set to ",(0,r.jsx)(n.code,{children:"true"})," to ensure cookies are only sent over HTTPS."]}),"\n"]}),"\n",(0,r.jsx)(n.h5,{id:"understanding-geopulse_cookie_domain",children:"Understanding GEOPULSE_COOKIE_DOMAIN"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"In GeoPulse's architecture"}),", nginx acts as a reverse proxy that serves both the frontend and proxies API requests to the backend. From the browser's perspective, all requests (frontend assets and API calls) come from the same origin (e.g., ",(0,r.jsx)(n.code,{children:"geopulse.yourdomain.com"}),"). This is called ",(0,r.jsx)(n.strong,{children:"same-origin"}),", and authentication cookies work automatically without setting a cookie domain."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to keep GEOPULSE_COOKIE_DOMAIN empty (recommended):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 All standard Docker deployments using docker-compose"}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Localhost access: ",(0,r.jsx)(n.code,{children:"http://localhost:5555"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Homelab IP access: ",(0,r.jsx)(n.code,{children:"http://1.8.068.1.100:5555"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Single domain production: ",(0,r.jsx)(n.code,{children:"https://geopulse.yourdomain.com"})]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Any deployment where nginx proxies both frontend and backend (standard GeoPulse setup)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why keep it empty?"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Browser automatically handles cookies for same-origin requests"}),"\n",(0,r.jsx)(n.li,{children:"More secure (cookies won't leak to other subdomains)"}),"\n",(0,r.jsx)(n.li,{children:"Simpler configuration with fewer potential issues"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to set GEOPULSE_COOKIE_DOMAIN (rare scenarios):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u274c Only if deploying WITHOUT nginx proxy AND using separate subdomains"}),"\n",(0,r.jsxs)(n.li,{children:["\u274c Example: Frontend at ",(0,r.jsx)(n.code,{children:"app.yourdomain.com"}),", Backend at ",(0,r.jsx)(n.code,{children:"api.yourdomain.com"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u274c In this case, set ",(0,r.jsx)(n.code,{children:"GEOPULSE_COOKIE_DOMAIN=.yourdomain.com"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u26a0\ufe0f ",(0,r.jsx)(n.strong,{children:"Warning"}),": This is NOT a standard GeoPulse deployment and requires additional configuration changes"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Scenario-based examples:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Localhost-only access:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"GEOPULSE_UI_URL=http://localhost:5555\nGEOPULSE_COOKIE_DOMAIN=           # Leave empty - nginx proxies everything\nGEOPULSE_AUTH_SECURE_COOKIES=false\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Homelab access (via IP address and/or local domain):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# Allows access via localhost, a local network IP, and a local domain\nGEOPULSE_UI_URL=http://localhost:5555,http://1.8.068.1.100:5555,http://geopulse.local\nGEOPULSE_COOKIE_DOMAIN=           # Leave empty - nginx proxies everything\nGEOPULSE_AUTH_SECURE_COOKIES=false\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Production access (with a domain and HTTPS):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"GEOPULSE_UI_URL=https://geopulse.yourdomain.com\nGEOPULSE_COOKIE_DOMAIN=           # Leave empty - nginx proxies everything\nGEOPULSE_AUTH_SECURE_COOKIES=true\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"advanced-performance-tuning",children:"Advanced Performance Tuning"}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:"\ud83d\ude80 Advanced Performance Tuning (Click to expand)"})}),(0,r.jsx)(n.h3,{id:"database-performance-tuning",children:"Database Performance Tuning"}),(0,r.jsx)(n.p,{children:"GeoPulse includes optimized PostgreSQL/PostGIS configurations tailored for GPS tracking workloads. Different deployment\nsizes use appropriate memory allocations and query optimization settings."}),(0,r.jsx)(n.h4,{id:"deployment-specific-database-settings",children:"Deployment-Specific Database Settings"}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Standard Deployment (docker-compose.yml and docker-compose-complete.yml)"})," - Minimal resource usage:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"shared_buffers=256MB"})," - Conservative memory allocation for typical deployments"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"work_mem=8MB"})," - Low memory per connection, suitable for 1-10 concurrent users"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"effective_cache_size=1GB"})," - Assumes minimal system memory available"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"log_min_duration_statement=5000ms"})," - Only log very slow queries"]}),"\n",(0,r.jsx)(n.li,{children:"Both files use identical PostgreSQL settings; complete version adds MQTT support only"}),"\n"]}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Development (docker-compose-dev.yml)"})," - Enhanced debugging with minimal resources:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"shared_buffers=128MB"})," - Very low memory usage for local development"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"work_mem=6MB"})," - Minimal memory per connection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"log_min_duration_statement=1000ms"})," - Detailed query monitoring for optimization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"track_functions=all"})," - Comprehensive function performance tracking"]}),"\n"]}),(0,r.jsx)(n.h4,{id:"environment-variable-configuration",children:"Environment Variable Configuration"}),(0,r.jsxs)(n.p,{children:["All PostgreSQL settings can be customized using environment variables in your ",(0,r.jsx)(n.code,{children:".env"})," file:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Memory Settings\nGEOPULSE_POSTGRES_SHARED_BUFFERS=512MB          # Main PostgreSQL buffer cache\nGEOPULSE_POSTGRES_WORK_MEM=16MB                 # Memory per connection for sorting/hashing\nGEOPULSE_POSTGRES_MAINTENANCE_WORK_MEM=128MB    # Memory for maintenance operations\nGEOPULSE_POSTGRES_EFFECTIVE_CACHE_SIZE=2GB      # Expected available OS cache\n\n# WAL and Checkpoint Settings\nGEOPULSE_POSTGRES_MAX_WAL_SIZE=1GB              # Maximum WAL size before checkpoint\nGEOPULSE_POSTGRES_WAL_BUFFERS=32MB              # WAL buffer size in memory\nGEOPULSE_POSTGRES_CHECKPOINT_TARGET=0.9         # Checkpoint completion target (0.0-1.0)\n\n# Performance Settings\nGEOPULSE_POSTGRES_RANDOM_PAGE_COST=1.1          # Cost of random page access (SSD optimized)\nGEOPULSE_POSTGRES_IO_CONCURRENCY=100            # Expected concurrent I/O operations\nGEOPULSE_POSTGRES_PARALLEL_WORKERS=2            # Max parallel workers per query\n\n# Autovacuum Settings\nGEOPULSE_POSTGRES_AUTOVACUUM_NAPTIME=60s        # Time between autovacuum runs\nGEOPULSE_POSTGRES_VACUUM_SCALE_FACTOR=0.2       # Vacuum threshold as fraction of table size\n\n# Logging Settings\nGEOPULSE_POSTGRES_LOG_SLOW_QUERIES=2000         # Log queries slower than this (ms)\nGEOPULSE_POSTGRES_LOG_CHECKPOINTS=off           # Log checkpoint activity\nGEOPULSE_POSTGRES_LOG_STATEMENT=none            # Log SQL statements (none/ddl/mod/all)\nGEOPULSE_POSTGRES_LOG_AUTOVACUUM=0              # Log autovacuum activity duration (ms)\nGEOPULSE_POSTGRES_TRACK_FUNCTIONS=none          # Track function performance (none/pl/all)\nGEOPULSE_POSTGRES_SYNC_COMMIT=on                # Synchronous commit mode\n"})}),(0,r.jsx)(n.h4,{id:"example-custom-configuration-for-high-performance-setup",children:"Example Custom Configuration for High-Performance Setup"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# High-performance .env settings (requires 4GB+ container)\nGEOPULSE_POSTGRES_SHARED_BUFFERS=1GB\nGEOPULSE_POSTGRES_WORK_MEM=24MB\nGEOPULSE_POSTGRES_MAINTENANCE_WORK_MEM=256MB\nGEOPULSE_POSTGRES_EFFECTIVE_CACHE_SIZE=3GB\nGEOPULSE_POSTGRES_MAX_WAL_SIZE=2GB\nGEOPULSE_POSTGRES_WAL_BUFFERS=64MB\nGEOPULSE_POSTGRES_PARALLEL_WORKERS=4\nGEOPULSE_POSTGRES_IO_CONCURRENCY=200\nGEOPULSE_POSTGRES_LOG_SLOW_QUERIES=1000\n"})}),(0,r.jsx)(n.h4,{id:"gps-workload-optimizations",children:"GPS Workload Optimizations"}),(0,r.jsx)(n.p,{children:"The database configurations include optimizations specific to GPS tracking applications:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spatial Query Performance"}),": ",(0,r.jsx)(n.code,{children:"random_page_cost=1.1"})," optimized for SSD storage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bulk GPS Inserts"}),": Enhanced ",(0,r.jsx)(n.code,{children:"wal_buffers"})," and checkpoint settings"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timeline Processing"}),": Optimized for large sequential scans and complex spatial joins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Concurrent Users"}),": ",(0,r.jsx)(n.code,{children:"work_mem"})," tuned to prevent memory exhaustion with multiple users"]}),"\n"]}),(0,r.jsx)(n.h4,{id:"monitoring-database-performance",children:"Monitoring Database Performance"}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Query Performance"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Monitor slow queries\nSELECT query, mean_exec_time, calls, total_exec_time\nFROM pg_stat_statements\nWHERE mean_exec_time > 1000\nORDER BY mean_exec_time DESC;\n"})}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Memory Usage"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Check buffer hit ratio (should be >99%)\nSELECT round(100.0 * blks_hit / (blks_hit + blks_read), 2) AS hit_ratio\nFROM pg_stat_database\nWHERE datname = current_database();\n"})}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Storage and Vacuum"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Monitor autovacuum performance\nSELECT schemaname, tablename, last_vacuum, last_autovacuum\nFROM pg_stat_user_tables\nWHERE tablename LIKE '%gps%'\n   OR tablename LIKE '%timeline%';\n"})})]}),"\n",(0,r.jsx)(n.h3,{id:"3-start-geopulse",children:"3. Start GeoPulse"}),"\n",(0,r.jsxs)(n.p,{children:["Once you have configured your ",(0,r.jsx)(n.code,{children:".env"})," file, you can start the application."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Access:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Frontend: ",(0,r.jsx)(n.a,{href:"http://localhost:5555",children:"http://localhost:5555"})," (or your configured URL)"]}),"\n",(0,r.jsxs)(n.li,{children:["API: ",(0,r.jsx)(n.a,{href:"http://localhost:8080/api",children:"http://localhost:8080/api"})]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"production-deployment-example-reverse-proxy",children:"Production Deployment Example: Reverse Proxy"}),"\n",(0,r.jsx)(n.p,{children:"For a production deployment using a domain name, you must terminate HTTPS at a reverse proxy and forward traffic to the GeoPulse containers."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Configure your ",(0,r.jsx)(n.code,{children:".env"})," file for production"]}),' (as shown in the "Web Access & Security Configuration" section).']}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Set up your reverse proxy."})," Here is a basic Nginx configuration example. You will also need to set up SSL certificates (e.g., using Let's Encrypt)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example Nginx Configuration"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"# /etc/nginx/sites-available/geopulse.conf\n\nserver {\n    listen 80;\n    server_name geopulse.yourdomain.com;\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl;\n    server_name geopulse.yourdomain.com;\n\n    # SSL certs\n    ssl_certificate /path/to/your/fullchain.pem;\n    ssl_certificate_key /path/to/your/privkey.pem;\n\n    # Frontend\n    location / {\n        proxy_pass http://localhost:5555;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Port conflicts:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker ps --format "table {{.Names}}\\t{{.Ports}}"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Service issues:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker compose logs -f\ncurl http://localhost:8080/api/health\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Authentication issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check domains match between frontend/backend"}),"\n",(0,r.jsxs)(n.li,{children:["For standard deployments (with nginx proxy): ",(0,r.jsx)(n.code,{children:'GEOPULSE_COOKIE_DOMAIN=""'})," (keep empty)"]}),"\n",(0,r.jsxs)(n.li,{children:["For HTTP deployments: ",(0,r.jsx)(n.code,{children:"GEOPULSE_AUTH_SECURE_COOKIES=false"})]}),"\n",(0,r.jsxs)(n.li,{children:["For HTTPS deployments: ",(0,r.jsx)(n.code,{children:"GEOPULSE_AUTH_SECURE_COOKIES=true"})]}),"\n",(0,r.jsxs)(n.li,{children:["Verify JWT keys exist in ",(0,r.jsx)(n.code,{children:"keys/"})," directory"]}),"\n",(0,r.jsx)(n.li,{children:'See the "Understanding GEOPULSE_COOKIE_DOMAIN" section above for detailed cookie configuration'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Network/Proxy issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"API requests failing: Check that frontend nginx proxy is configured correctly"}),"\n",(0,r.jsxs)(n.li,{children:["Multiple access methods not working: Ensure ",(0,r.jsx)(n.code,{children:"GEOPULSE_UI_URL"})," includes all required URLs (comma-separated)"]}),"\n",(0,r.jsxs)(n.li,{children:["CORS errors: Verify backend ",(0,r.jsx)(n.code,{children:"GEOPULSE_UI_URL"})," matches your access URLs"]}),"\n",(0,r.jsx)(n.li,{children:"Development proxy issues: Ensure Vite dev server is running with proxy configuration"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Check ",(0,r.jsx)(n.code,{children:".env"})," file is properly formatted and readable by containers"]}),"\n",(0,r.jsxs)(n.li,{children:["Verify ",(0,r.jsx)(n.code,{children:"GEOPULSE_BACKEND_URL"})," uses correct container name (",(0,r.jsx)(n.code,{children:"http://geopulse-backend:8080"})," for Docker)"]}),"\n",(0,r.jsxs)(n.li,{children:["For homelab: Use your actual IP addresses in ",(0,r.jsx)(n.code,{children:"GEOPULSE_UI_URL"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key generation issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["JWT keys and AI encryption keys are automatically generated in the ",(0,r.jsx)(n.code,{children:"keys/"})," directory on first startup"]}),"\n",(0,r.jsxs)(n.li,{children:["If you see key-related errors, check that the ",(0,r.jsx)(n.code,{children:"geopulse-keygen"})," service completed successfully:\n",(0,r.jsx)(n.code,{children:"docker compose logs geopulse-keygen"})]}),"\n",(0,r.jsx)(n.li,{children:"Keys are persistent - they won't be regenerated if they already exist"}),"\n",(0,r.jsxs)(n.li,{children:["To regenerate keys: remove the ",(0,r.jsx)(n.code,{children:"keys/"})," directory and restart with ",(0,r.jsx)(n.code,{children:"docker compose up -d"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CPU compatibility issues:"})}),"\n",(0,r.jsx)(n.p,{children:"If the backend container crashes immediately with errors about missing CPU features:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker compose logs geopulse-backend\n"})}),"\n",(0,r.jsx)(n.p,{children:"Look for errors like:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[AVX2, BMI1, BMI2, FMA, F16C, LZCNT]"})," (AMD64 CPUs)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[FP, ASIMD, CRC32, LSE]"})," (ARM64/Raspberry Pi)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),': Switch to the compatible image tag as described in the "CPU Compatibility Issues" section above. Edit your ',(0,r.jsx)(n.code,{children:"docker-compose.yml"})," to use ",(0,r.jsx)(n.code,{children:"${GEOPULSE_VERSION}-native-compat"})," instead of ",(0,r.jsx)(n.code,{children:"${GEOPULSE_VERSION}-native"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check your CPU capabilities:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# For x86/AMD64:\nlscpu | grep -i "flags"\n# Look for: avx2, bmi1, bmi2, fma\n\n# For ARM64:\ncat /proc/cpuinfo | grep "Features"\n# Look for: asimd, crc32, atomics\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var o=s(6540);const r={},i=o.createContext(r);function t(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);