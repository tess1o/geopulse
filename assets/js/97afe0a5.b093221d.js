"use strict";(globalThis.webpackChunkdocs_website=globalThis.webpackChunkdocs_website||[]).push([[799],{4114:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"getting-started/deployment/kubernetes-helm","title":"Kubernetes Deployment","description":"This guide explains how to deploy GeoPulse to a Kubernetes cluster using the provided helper scripts and Helm.","source":"@site/docs/getting-started/deployment/kubernetes-helm.md","sourceDirName":"getting-started/deployment","slug":"/getting-started/deployment/kubernetes-helm","permalink":"/geopulse/docs/getting-started/deployment/kubernetes-helm","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Docker Deployment","permalink":"/geopulse/docs/getting-started/deployment/docker-compose"},"next":{"title":"Connecting GPS Sources","permalink":"/geopulse/docs/user-guide/gps-sources/overview"}}');var r=s(4848),t=s(8453);const o={},i="Kubernetes Deployment",a={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation from helm repository",id:"installation-from-helm-repository",level:2},{value:"Installation from source code",id:"installation-from-source-code",level:2},{value:"1. Clone the Repository",id:"1-clone-the-repository",level:3},{value:"2. Make Scripts Executable",id:"2-make-scripts-executable",level:3},{value:"3. Install GeoPulse",id:"3-install-geopulse",level:3},{value:"4. Manage Your Deployment",id:"4-manage-your-deployment",level:3},{value:"Stop GeoPulse",id:"stop-geopulse",level:4},{value:"Start GeoPulse",id:"start-geopulse",level:4},{value:"Uninstall GeoPulse",id:"uninstall-geopulse",level:4},{value:"Advanced Customization",id:"advanced-customization",level:2},{value:"GeoPulse Installation Troubleshooting",id:"geopulse-installation-troubleshooting",level:2},{value:"1. Error: \u2717 Cannot connect to Kubernetes cluster",id:"1-error--cannot-connect-to-kubernetes-cluster",level:2},{value:"2. Error: INSTALLATION FAILED: Kubernetes cluster unreachable",id:"2-error-installation-failed-kubernetes-cluster-unreachable",level:2},{value:"3. Accessing GeoPulse UI",id:"3-accessing-geopulse-ui",level:2},{value:"Option 1 \u2014 Port-forward (temporary)",id:"option-1--port-forward-temporary",level:3},{value:"Option 2 \u2014 Change service type to NodePort (persistent)",id:"option-2--change-service-type-to-nodeport-persistent",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"kubernetes-deployment",children:"Kubernetes Deployment"})}),"\n",(0,r.jsx)(n.p,{children:"This guide explains how to deploy GeoPulse to a Kubernetes cluster using the provided helper scripts and Helm."}),"\n",(0,r.jsxs)(n.p,{children:["For advanced configuration and a full list of tunable parameters, please refer to the ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/geopulse/docs/getting-started/deployment/helm",children:"official chart README"})}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You have cloned this repository locally."}),"\n",(0,r.jsx)(n.li,{children:"Kubernetes cluster (1.19+)"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"kubectl"})," configured to access your cluster."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"helm"})," version 3.2.0+ installed."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation-from-helm-repository",children:"Installation from helm repository"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm repo add geopulse https://tess1o.github.io/geopulse/charts\nhelm repo update\nhelm install my-geopulse geopulse/geopulse\n"})}),"\n",(0,r.jsx)(n.h2,{id:"installation-from-source-code",children:"Installation from source code"}),"\n",(0,r.jsx)(n.h3,{id:"1-clone-the-repository",children:"1. Clone the Repository"}),"\n",(0,r.jsx)(n.p,{children:"First, ensure you have a local copy of the GeoPulse repository."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/tess1o/GeoPulse.git\ncd GeoPulse\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-make-scripts-executable",children:"2. Make Scripts Executable"}),"\n",(0,r.jsx)(n.p,{children:"The repository includes helper scripts to manage the deployment. You need to make them executable first."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x ./helm/*.sh\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-install-geopulse",children:"3. Install GeoPulse"}),"\n",(0,r.jsx)(n.p,{children:"The recommended way to install is with the interactive script, which will guide you through the available options."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./helm/install.sh\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The script will present several installation types, from a minimal test setup to a full production deployment, and will run the necessary ",(0,r.jsx)(n.code,{children:"helm"})," commands for you."]}),"\n",(0,r.jsx)(n.h3,{id:"4-manage-your-deployment",children:"4. Manage Your Deployment"}),"\n",(0,r.jsx)(n.p,{children:"You can easily start, stop, and uninstall your GeoPulse deployment using the provided scripts. This is useful for saving resources in a development environment."}),"\n",(0,r.jsx)(n.h4,{id:"stop-geopulse",children:"Stop GeoPulse"}),"\n",(0,r.jsx)(n.p,{children:"This command scales all components to zero, effectively pausing the application while preserving all data and configuration."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./helm/stop-geopulse.sh\n"})}),"\n",(0,r.jsx)(n.h4,{id:"start-geopulse",children:"Start GeoPulse"}),"\n",(0,r.jsx)(n.p,{children:"This resumes the application by scaling the components back up."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./helm/start-geopulse.sh\n"})}),"\n",(0,r.jsx)(n.h4,{id:"uninstall-geopulse",children:"Uninstall GeoPulse"}),"\n",(0,r.jsx)(n.p,{children:"This will completely remove the GeoPulse deployment from your cluster."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Warning:"})," By default, this will also delete the Persistent Volume Claims (PVCs), which means ",(0,r.jsx)(n.strong,{children:"all your data will be permanently deleted."})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./helm/uninstall-geopulse.sh\n"})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-customization",children:"Advanced Customization"}),"\n",(0,r.jsxs)(n.p,{children:["If the interactive installer does not cover your needs, you can bypass it and use ",(0,r.jsx)(n.code,{children:"helm"})," directly with a custom values file."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review Example Configurations:"})," The ",(0,r.jsx)(n.code,{children:"helm/examples/"})," directory contains templates for different scenarios, including the new ",(0,r.jsx)(n.code,{children:"medium-deployment.yaml"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Create ",(0,r.jsx)(n.code,{children:"my-values.yaml"}),":"]})," Copy and modify an example to create your own configuration."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Install Manually:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm install geopulse ./helm/geopulse -f my-values.yaml\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For a complete list of all available parameters, consult the ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/geopulse/docs/getting-started/deployment/helm",children:"Helm Chart README"})}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"geopulse-installation-troubleshooting",children:"GeoPulse Installation Troubleshooting"}),"\n",(0,r.jsx)(n.p,{children:"This guide covers common issues during GeoPulse Helm installation on k3s and how to fix them."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-error--cannot-connect-to-kubernetes-cluster",children:"1. Error: \u2717 Cannot connect to Kubernetes cluster"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Symptom:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u2717 Cannot connect to Kubernetes cluster\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause:"})," kubectl cannot access your k3s cluster from the current user environment."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsx)(n.p,{children:"Ensure k3s is running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status k3s\n"})}),"\n",(0,r.jsx)(n.p,{children:"Make kubeconfig available to your user:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/.kube\nsudo cp /etc/rancher/k3s/k3s.yaml ~/.kube/config\nsudo chown $USER:$USER ~/.kube/config\n"})}),"\n",(0,r.jsx)(n.p,{children:"Export KUBECONFIG (if not already set):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export KUBECONFIG=~/.kube/config\n"})}),"\n",(0,r.jsx)(n.p,{children:"Test connectivity:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get nodes\nkubectl cluster-info\n"})}),"\n",(0,r.jsx)(n.p,{children:"Re-run the installer:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./helm/install.sh\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," If you previously ran the script with sudo, try running it without sudo after setting KUBECONFIG."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-error-installation-failed-kubernetes-cluster-unreachable",children:"2. Error: INSTALLATION FAILED: Kubernetes cluster unreachable"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Symptom:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Error: INSTALLATION FAILED: Kubernetes cluster unreachable: the server could not find the requested resource\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause:"})," Helm cannot find the cluster because ",(0,r.jsx)(n.code,{children:"$KUBECONFIG"})," is missing or not passed to sudo."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option 1 \u2014 Run without sudo (recommended):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./helm/install.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option 2 \u2014 Run with sudo and explicit KUBECONFIG:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo KUBECONFIG=/etc/rancher/k3s/k3s.yaml ./helm/install.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Option 3 \u2014 Patch the install script to automatically export kubeconfig:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'if [ -z "$KUBECONFIG" ]; then\n    export KUBECONFIG=/etc/rancher/k3s/k3s.yaml\nfi\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-accessing-geopulse-ui",children:"3. Accessing GeoPulse UI"}),"\n",(0,r.jsxs)(n.p,{children:["The GeoPulse frontend service (",(0,r.jsx)(n.code,{children:"geopulse-frontend"}),") listens on port 80 in the cluster."]}),"\n",(0,r.jsx)(n.h3,{id:"option-1--port-forward-temporary",children:"Option 1 \u2014 Port-forward (temporary)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward -n default svc/geopulse-frontend 5555:80 --address 0.0.0.0\n"})}),"\n",(0,r.jsx)(n.p,{children:"Access from any machine on the network:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"http://<server-ip>:5555\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"<server-ip>"})," with your k3s host LAN IP:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hostname -I | awk '{print $1}'\n"})}),"\n",(0,r.jsx)(n.h3,{id:"option-2--change-service-type-to-nodeport-persistent",children:"Option 2 \u2014 Change service type to NodePort (persistent)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl edit svc geopulse-frontend -n default\n"})}),"\n",(0,r.jsx)(n.p,{children:"Change:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"type: ClusterIP\n"})}),"\n",(0,r.jsx)(n.p,{children:"to:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"type: NodePort\n"})}),"\n",(0,r.jsx)(n.p,{children:"Save and get the assigned NodePort:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get svc -n default\n"})}),"\n",(0,r.jsx)(n.p,{children:"Access the UI from a network machine:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"http://<server-ip>:<node-port>\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>i});var l=s(6540);const r={},t=l.createContext(r);function o(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);