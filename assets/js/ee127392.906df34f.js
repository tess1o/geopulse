"use strict";(globalThis.webpackChunkdocs_website=globalThis.webpackChunkdocs_website||[]).push([[9475],{1899:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"user-guide/timeline/stay_detection","title":"Stay Detection","description":"How GeoPulse identifies when you\'ve stayed at a location using GPS clustering and duration analysis.","source":"@site/docs/user-guide/timeline/stay_detection.md","sourceDirName":"user-guide/timeline","slug":"/user-guide/timeline/stay_detection","permalink":"/geopulse/docs/user-guide/timeline/stay_detection","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Stay Detection","description":"How GeoPulse identifies when you\'ve stayed at a location using GPS clustering and duration analysis."},"sidebar":"docsSidebar","previous":{"title":"Understanding Your Timeline: How It Works","permalink":"/geopulse/docs/user-guide/core-features/timeline"},"next":{"title":"Trip Detection","permalink":"/geopulse/docs/user-guide/timeline/trip_detection"}}');var t=i(4848),r=i(8453);const l={title:"Stay Detection",description:"How GeoPulse identifies when you've stayed at a location using GPS clustering and duration analysis."},a="Stay Detection",d={},o=[{value:"Overview",id:"overview",level:2},{value:"The Detection State Machine",id:"the-detection-state-machine",level:2},{value:"State Descriptions",id:"state-descriptions",level:3},{value:"How a Stay is Detected",id:"how-a-stay-is-detected",level:2},{value:"Step 1: Initial Clustering",id:"step-1-initial-clustering",level:3},{value:"Step 2: Distance Check",id:"step-2-distance-check",level:3},{value:"Step 3: Duration Confirmation",id:"step-3-duration-confirmation",level:3},{value:"Step 4: Stay Finalization",id:"step-4-stay-finalization",level:3},{value:"Key Settings Explained",id:"key-settings-explained",level:2},{value:"Stay Detection Radius",id:"stay-detection-radius",level:3},{value:"Minimum Stay Duration",id:"minimum-stay-duration",level:3},{value:"GPS Quality Filtering",id:"gps-quality-filtering",level:2},{value:"Accuracy-Based Point Filtering",id:"accuracy-based-point-filtering",level:3},{value:"Cluster Quality Validation",id:"cluster-quality-validation",level:3},{value:"Enhanced Filtering Toggle",id:"enhanced-filtering-toggle",level:3},{value:"Favorite Areas: Special Handling",id:"favorite-areas-special-handling",level:2},{value:"The Problem",id:"the-problem",level:3},{value:"The Solution",id:"the-solution",level:3},{value:"Practical Examples",id:"practical-examples",level:3},{value:"Trip Detection and Stay Endings",id:"trip-detection-and-stay-endings",level:2},{value:"How Movement is Detected",id:"how-movement-is-detected",level:3},{value:"Returning to IN_TRIP Mode",id:"returning-to-in_trip-mode",level:3},{value:"Trip Ending Detection",id:"trip-ending-detection",level:3},{value:"Location Resolution",id:"location-resolution",level:2},{value:"Resolution Priority",id:"resolution-priority",level:3},{value:"Batch Processing",id:"batch-processing",level:3},{value:"What Gets Assigned",id:"what-gets-assigned",level:3},{value:"Configuration Recommendations",id:"configuration-recommendations",level:2},{value:"For Different Use Cases",id:"for-different-use-cases",level:3},{value:"For Different GPS Quality",id:"for-different-gps-quality",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Problem: GPS points at one location create multiple stays",id:"problem-gps-points-at-one-location-create-multiple-stays",level:3},{value:"Problem: Nearby distinct locations merge into one stay",id:"problem-nearby-distinct-locations-merge-into-one-stay",level:3},{value:"Problem: Short stops aren&#39;t being detected",id:"problem-short-stops-arent-being-detected",level:3},{value:"Problem: Traffic delays appear as stays",id:"problem-traffic-delays-appear-as-stays",level:3},{value:"Problem: Stays have wrong or missing location names",id:"problem-stays-have-wrong-or-missing-location-names",level:3},{value:"Impact on Timeline Rebuild",id:"impact-on-timeline-rebuild",level:2},{value:"Related Settings",id:"related-settings",level:2},{value:"Summary",id:"summary",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"stay-detection",children:"Stay Detection"})}),"\n",(0,t.jsx)(n.p,{children:"GeoPulse uses a sophisticated algorithm to identify when you've stopped at a location. This document explains the complete process of how stays are detected, from initial clustering to confirmation."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Stay detection is the foundation of timeline generation. The system analyzes your GPS data to identify periods when you were stationary at a specific location. A stay is created when:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GPS points cluster together"})," within a defined radius"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"You remain stationary"})," for a minimum duration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GPS data quality"})," meets accuracy requirements"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The algorithm uses a ",(0,t.jsx)(n.strong,{children:"state machine"})," that transitions between states as it processes each GPS point, making decisions based on distance, time, and movement patterns."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"the-detection-state-machine",children:"The Detection State Machine"}),"\n",(0,t.jsx)(n.p,{children:"GeoPulse processes GPS points sequentially through a four-state machine:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"UNKNOWN \u2192 POTENTIAL_STAY \u2192 CONFIRMED_STAY\n                \u2193               \u2193\n              IN_TRIP \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(n.h3,{id:"state-descriptions",children:"State Descriptions"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"State"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"What Triggers Exit"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"UNKNOWN"})}),(0,t.jsx)(n.td,{children:"Initial state before any GPS data"}),(0,t.jsx)(n.td,{children:"First GPS point received"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"POTENTIAL_STAY"})}),(0,t.jsx)(n.td,{children:"Clustering in progress, not yet confirmed"}),(0,t.jsx)(n.td,{children:"Duration threshold met OR movement detected"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"CONFIRMED_STAY"})}),(0,t.jsx)(n.td,{children:"Valid stay identified"}),(0,t.jsx)(n.td,{children:"Movement beyond stay radius"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"IN_TRIP"})}),(0,t.jsx)(n.td,{children:"Moving between locations"}),(0,t.jsx)(n.td,{children:"Sustained stop detected"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"how-a-stay-is-detected",children:"How a Stay is Detected"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-initial-clustering",children:"Step 1: Initial Clustering"}),"\n",(0,t.jsxs)(n.p,{children:["When the first GPS point arrives, the system enters ",(0,t.jsx)(n.strong,{children:"POTENTIAL_STAY"})," mode and begins building a cluster:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"The first point becomes the seed of the cluster"}),"\n",(0,t.jsxs)(n.li,{children:["Each subsequent point is compared to the cluster's ",(0,t.jsx)(n.strong,{children:"centroid"})," (center point)"]}),"\n",(0,t.jsx)(n.li,{children:"The centroid is calculated as the mean latitude and longitude of all clustered points"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"step-2-distance-check",children:"Step 2: Distance Check"}),"\n",(0,t.jsx)(n.p,{children:"For each new GPS point, the system calculates the distance from the current centroid:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"If distance \u2264 Stay Detection Radius:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Point is added to the cluster"}),"\n",(0,t.jsx)(n.li,{children:"Centroid is recalculated"}),"\n",(0,t.jsx)(n.li,{children:"Continue clustering"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"If distance > Stay Detection Radius:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Check for ",(0,t.jsx)(n.a,{href:"#favorite-areas-special-handling",children:"Favorite Area"})," containment"]}),"\n",(0,t.jsxs)(n.li,{children:["If not in same area: transition to ",(0,t.jsx)(n.strong,{children:"IN_TRIP"})]}),"\n",(0,t.jsx)(n.li,{children:"Current cluster becomes a trip starting point"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"step-3-duration-confirmation",children:"Step 3: Duration Confirmation"}),"\n",(0,t.jsx)(n.p,{children:"While clustering continues (distance checks pass), the system tracks the total duration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Duration = Last point timestamp - First point timestamp\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"If duration \u2265 Minimum Stay Duration:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Transition from POTENTIAL_STAY to ",(0,t.jsx)(n.strong,{children:"CONFIRMED_STAY"})]}),"\n",(0,t.jsx)(n.li,{children:"Stay is now considered valid"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"If duration < Minimum Stay Duration:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Remain in POTENTIAL_STAY"}),"\n",(0,t.jsx)(n.li,{children:"Continue collecting points"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"step-4-stay-finalization",children:"Step 4: Stay Finalization"}),"\n",(0,t.jsx)(n.p,{children:"A confirmed stay ends when movement is detected:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"New GPS point falls outside the stay radius"}),"\n",(0,t.jsx)(n.li,{children:"Point is not within a shared Favorite Area"}),"\n",(0,t.jsxs)(n.li,{children:["System finalizes the stay with:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Start time (first clustered point)"}),"\n",(0,t.jsx)(n.li,{children:"Duration (last - first timestamp)"}),"\n",(0,t.jsx)(n.li,{children:"Location (centroid coordinates)"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Transition to ",(0,t.jsx)(n.strong,{children:"IN_TRIP"})," mode"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"key-settings-explained",children:"Key Settings Explained"}),"\n",(0,t.jsx)(n.h3,{id:"stay-detection-radius",children:"Stay Detection Radius"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Setting:"})," ",(0,t.jsx)(n.code,{children:"Stay Detection Radius"}),"\n",(0,t.jsx)(n.strong,{children:"Default:"})," 50 meters\n",(0,t.jsx)(n.strong,{children:"Range:"})," 10-500 meters"]}),"\n",(0,t.jsx)(n.p,{children:'This defines the size of the "bubble" used for clustering GPS points.'}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Value"}),(0,t.jsx)(n.th,{children:"Effect"}),(0,t.jsx)(n.th,{children:"Best For"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"10-30m"})}),(0,t.jsx)(n.td,{children:"Very sensitive, separate nearby locations"}),(0,t.jsx)(n.td,{children:"Dense urban areas, multiple stores in a mall"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"50m"})}),(0,t.jsx)(n.td,{children:"Balanced detection"}),(0,t.jsx)(n.td,{children:"Most users, typical accuracy"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"100-200m"})}),(0,t.jsx)(n.td,{children:"Merge nearby locations"}),(0,t.jsx)(n.td,{children:"Poor GPS areas, large venues"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"300-500m"})}),(0,t.jsx)(n.td,{children:"Very conservative"}),(0,t.jsx)(n.td,{children:"Extremely poor GPS, general location tracking"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Trade-offs:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Smaller radius:"})," More precise but may split single visits due to GPS drift"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Larger radius:"})," More stable but may merge distinct nearby locations"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"GPS Drift Consideration",type:"tip",children:(0,t.jsx)(n.p,{children:"If your GPS device has accuracy issues (\xb130-50m), use a larger radius (75-100m) to prevent artificial stay splits from GPS wandering."})}),"\n",(0,t.jsx)(n.h3,{id:"minimum-stay-duration",children:"Minimum Stay Duration"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Setting:"})," ",(0,t.jsx)(n.code,{children:"Minimum Stay Duration"}),"\n",(0,t.jsx)(n.strong,{children:"Default:"})," 7 minutes\n",(0,t.jsx)(n.strong,{children:"Range:"})," 1-60 minutes"]}),"\n",(0,t.jsx)(n.p,{children:"The minimum time you must remain stationary for a stay to be confirmed."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Value"}),(0,t.jsx)(n.th,{children:"Effect"}),(0,t.jsx)(n.th,{children:"Best For"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"1-3 min"})}),(0,t.jsx)(n.td,{children:"Detect very short stops"}),(0,t.jsx)(n.td,{children:"Delivery drivers, frequent short stops"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"5-7 min"})}),(0,t.jsx)(n.td,{children:"Balanced detection"}),(0,t.jsx)(n.td,{children:"Most users"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"10-15 min"})}),(0,t.jsx)(n.td,{children:"Filter out traffic delays"}),(0,t.jsx)(n.td,{children:"Commuters, road trips"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"20-60 min"})}),(0,t.jsx)(n.td,{children:"Only significant stays"}),(0,t.jsx)(n.td,{children:"Business meetings, appointments only"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Trade-offs:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Shorter duration:"})," More sensitive but may capture traffic stops as stays"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Longer duration:"})," Cleaner timeline but may miss brief meaningful stops"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"Traffic Light Problem",type:"warning",children:(0,t.jsx)(n.p,{children:"Setting duration too low (1-2 minutes) will cause extended traffic stops to appear as stays. The default 7 minutes filters most traffic delays while capturing genuine stops."})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"gps-quality-filtering",children:"GPS Quality Filtering"}),"\n",(0,t.jsx)(n.p,{children:"GeoPulse uses multiple layers of quality filtering to ensure accurate stay detection."}),"\n",(0,t.jsx)(n.h3,{id:"accuracy-based-point-filtering",children:"Accuracy-Based Point Filtering"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Setting:"})," ",(0,t.jsx)(n.code,{children:"GPS Accuracy Threshold"}),"\n",(0,t.jsx)(n.strong,{children:"Default:"})," 60 meters\n",(0,t.jsx)(n.strong,{children:"Range:"})," 5-200 meters"]}),"\n",(0,t.jsxs)(n.p,{children:["Points with accuracy worse than this threshold are ",(0,t.jsx)(n.strong,{children:"excluded"})," from processing entirely."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"If GPS point accuracy > threshold:\n  \u2192 Point is ignored (not processed)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Why this matters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Poor GPS accuracy (>60m) indicates the device is uncertain about location"}),"\n",(0,t.jsx)(n.li,{children:"Including these points would degrade cluster quality"}),"\n",(0,t.jsx)(n.li,{children:"Filtered points don't affect stay detection at all"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"cluster-quality-validation",children:"Cluster Quality Validation"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Setting:"})," ",(0,t.jsx)(n.code,{children:"Minimum Accuracy Ratio"}),"\n",(0,t.jsx)(n.strong,{children:"Default:"})," 50% (0.5)\n",(0,t.jsx)(n.strong,{children:"Range:"})," 10-100%"]}),"\n",(0,t.jsx)(n.p,{children:"After a stay cluster is formed, the system validates overall quality:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Accurate points = count(points with accuracy \u2264 threshold)\nRatio = Accurate points / Total points\n\nIf ratio < Minimum Accuracy Ratio:\n  \u2192 Stay is rejected\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"10 points in a cluster"}),"\n",(0,t.jsx)(n.li,{children:"4 points have accuracy \u2264 60m (good)"}),"\n",(0,t.jsx)(n.li,{children:"6 points have accuracy > 60m (poor)"}),"\n",(0,t.jsx)(n.li,{children:"Ratio = 4/10 = 40%"}),"\n",(0,t.jsxs)(n.li,{children:["With default 50% threshold: ",(0,t.jsx)(n.strong,{children:"Stay rejected"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This ensures that stays are only created when sufficient high-quality GPS data exists."}),"\n",(0,t.jsx)(n.h3,{id:"enhanced-filtering-toggle",children:"Enhanced Filtering Toggle"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Setting:"})," ",(0,t.jsx)(n.code,{children:"Enhanced Filtering"}),"\n",(0,t.jsx)(n.strong,{children:"Default:"})," Enabled"]}),"\n",(0,t.jsx)(n.p,{children:"When enabled, the system uses both accuracy and velocity data for filtering. When disabled:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All accuracy-based filtering is bypassed"}),"\n",(0,t.jsx)(n.li,{children:"Useful for GPS sources that don't report accuracy"}),"\n",(0,t.jsx)(n.li,{children:"May result in lower quality stay detection"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"favorite-areas-special-handling",children:"Favorite Areas: Special Handling"}),"\n",(0,t.jsx)(n.p,{children:'Favorite Areas receive special treatment during stay detection to handle large venues where you might walk around but still be "at" the location.'}),"\n",(0,t.jsx)(n.h3,{id:"the-problem",children:"The Problem"}),"\n",(0,t.jsx)(n.p,{children:"Consider a shopping mall:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You enter and walk to different stores"}),"\n",(0,t.jsx)(n.li,{children:"Movement between stores might exceed 50m"}),"\n",(0,t.jsx)(n.li,{children:"Without special handling, this creates multiple separate stays"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"the-solution",children:"The Solution"}),"\n",(0,t.jsx)(n.p,{children:"When movement exceeds the stay radius, the system checks if both points are within the same Favorite Area:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"1. Calculate distance from centroid to new point\n2. If distance > stay radius:\n   a. Find Favorite Area containing the centroid\n   b. Find Favorite Area containing the new point\n   c. If same area: Continue stay (point added to cluster)\n   d. If different areas: Transition to IN_TRIP\n"})}),"\n",(0,t.jsx)(n.h3,{id:"practical-examples",children:"Practical Examples"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"University Campus (defined as Favorite Area):"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You arrive at the library"}),"\n",(0,t.jsx)(n.li,{children:"Walk to the cafeteria (500m away)"}),"\n",(0,t.jsx)(n.li,{children:"Walk to your classroom (300m from cafeteria)"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Result:"}),' Single continuous stay at "University Campus"']}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Two Shops in Same Mall (no Favorite Area defined):"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You visit Store A"}),"\n",(0,t.jsx)(n.li,{children:"Walk to Store B (100m away)"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Result:"})," Two separate stays (Store A, Store B)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Same Scenario with Mall as Favorite Area:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You visit Store A"}),"\n",(0,t.jsx)(n.li,{children:"Walk to Store B"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Result:"}),' Single stay at "Shopping Mall"']}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"Creating Favorite Areas",type:"tip",children:(0,t.jsx)(n.p,{children:"Define Favorite Areas for large venues you visit regularly (campuses, malls, office complexes) to get cleaner timeline entries instead of multiple fragmented stays."})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"trip-detection-and-stay-endings",children:"Trip Detection and Stay Endings"}),"\n",(0,t.jsx)(n.h3,{id:"how-movement-is-detected",children:"How Movement is Detected"}),"\n",(0,t.jsx)(n.p,{children:"A confirmed stay ends when the system detects you've moved away:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"New GPS point is received"}),"\n",(0,t.jsx)(n.li,{children:"Distance to centroid is calculated"}),"\n",(0,t.jsxs)(n.li,{children:["If distance > stay radius AND not in same Favorite Area:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Stay is finalized"}),"\n",(0,t.jsx)(n.li,{children:"Trip begins with the new point"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"returning-to-in_trip-mode",children:"Returning to IN_TRIP Mode"}),"\n",(0,t.jsx)(n.p,{children:"When movement is detected:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Current State: CONFIRMED_STAY\nAction: Receive point 120m from centroid (radius: 50m)\nResult:\n  1. Finalize stay (startTime, duration, location)\n  2. Clear active cluster\n  3. Start new trip with this point\n  4. Transition to IN_TRIP\n"})}),"\n",(0,t.jsx)(n.h3,{id:"trip-ending-detection",children:"Trip Ending Detection"}),"\n",(0,t.jsxs)(n.p,{children:["For details on how trips end and new stays begin, see ",(0,t.jsx)(n.a,{href:"/docs/user-guide/timeline/trip_detection",children:"Trip Detection"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"location-resolution",children:"Location Resolution"}),"\n",(0,t.jsxs)(n.p,{children:["After a stay is detected, the system determines ",(0,t.jsx)(n.strong,{children:"where"})," you were:"]}),"\n",(0,t.jsx)(n.h3,{id:"resolution-priority",children:"Resolution Priority"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Favorite Locations"})," - Check if centroid matches a user-defined favorite"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Geocoding Results"})," - Look up address/place name from coordinates"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"batch-processing",children:"Batch Processing"}),"\n",(0,t.jsx)(n.p,{children:"Location resolution is performed in batches after all stays are detected:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Single database query for all stays"}),"\n",(0,t.jsx)(n.li,{children:"Matches against favorites and geocoding cache"}),"\n",(0,t.jsx)(n.li,{children:"Reduces processing time significantly"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-gets-assigned",children:"What Gets Assigned"}),"\n",(0,t.jsx)(n.p,{children:"Each stay receives:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"locationName"}),' - Display name (e.g., "Home", "Work", or street address)']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"favoriteId"})," - Link to matching favorite location (if any)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"geocodingId"})," - Link to geocoding result (if any)"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"configuration-recommendations",children:"Configuration Recommendations"}),"\n",(0,t.jsx)(n.h3,{id:"for-different-use-cases",children:"For Different Use Cases"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Personal Location Tracking:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 50m (default)\nMinimum Stay Duration: 7 minutes (default)\nGPS Accuracy Threshold: 60m (default)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Delivery/Field Service:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 30m (more precise)\nMinimum Stay Duration: 2-3 minutes (catch quick stops)\nGPS Accuracy Threshold: 30m (stricter quality)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Road Trip Tracking:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 75-100m (account for parking lot size)\nMinimum Stay Duration: 10-15 minutes (filter rest stops)\nGPS Accuracy Threshold: 60m (default)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Urban High-Density:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 30-40m (separate nearby venues)\nMinimum Stay Duration: 5 minutes (default)\nGPS Accuracy Threshold: 50m (stricter for cities)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"for-different-gps-quality",children:"For Different GPS Quality"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"High-Quality GPS (modern phone):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 30-50m\nGPS Accuracy Threshold: 30m\nMinimum Accuracy Ratio: 70%\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Average GPS Quality:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 50-75m\nGPS Accuracy Threshold: 60m\nMinimum Accuracy Ratio: 50%\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Poor GPS Quality (indoor, urban canyons):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Stay Detection Radius: 100m\nGPS Accuracy Threshold: 100m\nMinimum Accuracy Ratio: 30%\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"problem-gps-points-at-one-location-create-multiple-stays",children:"Problem: GPS points at one location create multiple stays"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Possible Causes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Stay radius too small for GPS accuracy"}),"\n",(0,t.jsx)(n.li,{children:"GPS drift exceeding radius threshold"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Increase ",(0,t.jsx)(n.strong,{children:"Stay Detection Radius"})," to 75-100m"]}),"\n",(0,t.jsx)(n.li,{children:"Check GPS source accuracy settings"}),"\n",(0,t.jsx)(n.li,{children:"Consider defining a Favorite Area for the location"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"problem-nearby-distinct-locations-merge-into-one-stay",children:"Problem: Nearby distinct locations merge into one stay"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Possible Causes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Stay radius too large"}),"\n",(0,t.jsx)(n.li,{children:"Both locations fall within same radius"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Decrease ",(0,t.jsx)(n.strong,{children:"Stay Detection Radius"})," to 30-40m"]}),"\n",(0,t.jsx)(n.li,{children:"Ensure GPS accuracy is sufficient"}),"\n",(0,t.jsx)(n.li,{children:"Define separate Favorite Locations for each place"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"problem-short-stops-arent-being-detected",children:"Problem: Short stops aren't being detected"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Possible Causes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Minimum stay duration too long"}),"\n",(0,t.jsx)(n.li,{children:"Not enough GPS points during the stop"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Decrease ",(0,t.jsx)(n.strong,{children:"Minimum Stay Duration"})," to 3-5 minutes"]}),"\n",(0,t.jsx)(n.li,{children:"Check GPS tracking frequency (should be every 30-60 seconds)"}),"\n",(0,t.jsx)(n.li,{children:"Verify GPS accuracy isn't filtering out points"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"problem-traffic-delays-appear-as-stays",children:"Problem: Traffic delays appear as stays"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Possible Causes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Minimum stay duration too short"}),"\n",(0,t.jsx)(n.li,{children:"Extended traffic stopped in same location"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Increase ",(0,t.jsx)(n.strong,{children:"Minimum Stay Duration"})," to 10-15 minutes"]}),"\n",(0,t.jsx)(n.li,{children:"Use default 7-minute threshold for most cases"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"problem-stays-have-wrong-or-missing-location-names",children:"Problem: Stays have wrong or missing location names"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Possible Causes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"No Favorite Location defined for the place"}),"\n",(0,t.jsx)(n.li,{children:"Geocoding hasn't processed the coordinates"}),"\n",(0,t.jsx)(n.li,{children:"Stay centroid is slightly off from actual location"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a Favorite Location for frequently visited places"}),"\n",(0,t.jsx)(n.li,{children:"Wait for reverse geocoding to complete"}),"\n",(0,t.jsx)(n.li,{children:"Check if stay radius needs adjustment"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"impact-on-timeline-rebuild",children:"Impact on Timeline Rebuild"}),"\n",(0,t.jsxs)(n.p,{children:["Changing stay detection settings triggers a ",(0,t.jsx)(n.strong,{children:"full timeline rebuild"}),":"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What Changes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All stays are re-detected with new parameters"}),"\n",(0,t.jsx)(n.li,{children:"Stay boundaries and durations may change"}),"\n",(0,t.jsx)(n.li,{children:"Some stays may split or merge"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What Doesn't Change:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Original GPS data remains intact"}),"\n",(0,t.jsx)(n.li,{children:"Favorite locations are preserved"}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"Rebuild Time",type:"info",children:(0,t.jsx)(n.p,{children:"After changing stay detection settings, the timeline will rebuild from your earliest GPS data. For large datasets, this may take several minutes. You'll see a progress indicator showing the rebuild status."})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"related-settings",children:"Related Settings"}),"\n",(0,t.jsx)(n.p,{children:"Stay detection works together with other timeline features:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/user-guide/timeline/trip_detection",children:"Trip Detection"})})," - How movement between stays is detected"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/user-guide/timeline/data_gaps",children:"Data Gaps"})})," - How missing GPS data is handled"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/user-guide/timeline/travel_classification",children:"Travel Classification"})})," - How trip types are determined"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"Stay detection identifies when you've stopped at a location using GPS clustering:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Clustering algorithm"})," groups nearby GPS points"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Distance threshold"})," (Stay Detection Radius) defines cluster size"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Duration threshold"})," (Minimum Stay Duration) confirms valid stays"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Quality filtering"})," ensures reliable GPS data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Favorite Areas"})," handle large venues specially"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"By understanding these settings and adjusting them for your GPS quality and use case, you can ensure GeoPulse accurately captures all your meaningful stays while filtering out noise and false positives."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);